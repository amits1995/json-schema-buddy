(function(){function i(){if(!(this instanceof i))return new i;this.coerceType={};this.fieldType=t(s);this.fieldValidate=t(c);this.fieldFormat=t(h);this.defaultOptions=t(a);this.schema={}}var t=function(n){var i,r,f,u;if(n===null||typeof n!="object")return n;if(n instanceof Date)return i=new Date,i.setTime(n.getTime()),i;if(n instanceof RegExp)return new RegExp(n);if(n instanceof Array){for(i=[],r=0,f=n.length;r<f;r++)i[r]=t(n[r]);return i}if(n instanceof Object){i={};for(u in n)n.hasOwnProperty(u)&&(i[u]=t(n[u]));return i}throw new Error("Unable to clone object!");},r=function(n){for(var i=[t(n[0])],r=i[0].key,u=i[0].object,f=1,e=n.length;f<e;f++)u=u[r],r=n[f].key,i.push({object:u,key:r});return i},f=function(n,t){var i=n.length-1,r=n[i].key;t[i].object[r]=n[i].object[r]},o={type:!0,not:!0,anyOf:!0,allOf:!0,oneOf:!0,$ref:!0,$schema:!0,id:!0,exclusiveMaximum:!0,exclusiveMininum:!0,properties:!0,patternProperties:!0,additionalProperties:!0,items:!0,additionalItems:!0,required:!0,"default":!0,title:!0,description:!0,definitions:!0,dependencies:!0},s={"null":function(n){return n===null},string:function(n){return typeof n=="string"},boolean:function(n){return typeof n=="boolean"},number:function(n){return typeof n=="number"&&n===n},integer:function(n){return typeof n=="number"&&n%1==0},object:function(n){return n&&typeof n=="object"&&!Array.isArray(n)},array:function(n){return Array.isArray(n)},date:function(n){return n instanceof Date}},h={alpha:function(n){return/^[a-zA-Z]+$/.test(n)},alphanumeric:function(n){return/^[a-zA-Z0-9]+$/.test(n)},identifier:function(n){return/^[-_a-zA-Z0-9]+$/.test(n)},hexadecimal:function(n){return/^[a-fA-F0-9]+$/.test(n)},numeric:function(n){return/^[0-9]+$/.test(n)},"date-time":function(n){return!isNaN(Date.parse(n))&&n.indexOf("/")===-1},uppercase:function(n){return n===n.toUpperCase()},lowercase:function(n){return n===n.toLowerCase()},hostname:function(n){return n.length<256&&/^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])(\.([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9]))*$/.test(n)},uri:function(n){return/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/.test(n)},email:function(n){return/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/.test(n)},ipv4:function(n){if(/^(\d?\d?\d)\.(\d?\d?\d)\.(\d?\d?\d)\.(\d?\d?\d)$/.test(n)){var t=n.split(".").sort();if(t[3]<=255)return!0}return!1},ipv6:function(n){return/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/.test(n)}},c={readOnly:function(){return!1},minimum:function(n,t,i){return!(n<t||i.exclusiveMinimum&&n<=t)},maximum:function(n,t,i){return!(n>t||i.exclusiveMaximum&&n>=t)},multipleOf:function(n,t){return n/t%1==0||typeof n!="number"},pattern:function(n,t){var i,r,u;return typeof n!="string"?!0:(typeof t=="string"?i=t:(i=t[0],r=t[1]),u=new RegExp(i,r),u.test(n))},minLength:function(n,t){return n.length>=t||typeof n!="string"},maxLength:function(n,t){return n.length<=t||typeof n!="string"},minItems:function(n,t){return n.length>=t||!Array.isArray(n)},maxItems:function(n,t){return n.length<=t||!Array.isArray(n)},uniqueItems:function(n){for(var r={},t,i=0,u=n.length;i<u;i++){if(t=JSON.stringify(n[i]),r.hasOwnProperty(t))return!1;r[t]=!0}return!0},minProperties:function(n,t){var i,r;if(typeof n!="object")return!0;i=0;for(r in n)n.hasOwnProperty(r)&&(i=i+1);return i>=t},maxProperties:function(n,t){var i,r;if(typeof n!="object")return!0;i=0;for(r in n)n.hasOwnProperty(r)&&(i=i+1);return i<=t},constant:function(n,t){return JSON.stringify(n)==JSON.stringify(t)},"enum":function(n,t){var i,r,u;if(typeof n=="object"){for(u=JSON.stringify(n),i=0,r=t.length;i<r;i++)if(u===JSON.stringify(t[i]))return!0}else for(i=0,r=t.length;i<r;i++)if(n===t[i])return!0;return!1}},e=function(n){return n.indexOf("://")===-1?n:n.split("#")[0]},u=function(n,t,i){var r,u,f,e;if(f=i.indexOf("#"),f===-1)return n.schema.hasOwnProperty(i)?[n.schema[i]]:null;if(f>0)if(e=i.substr(0,f),i=i.substr(f+1),n.schema.hasOwnProperty(e))t=[n.schema[e]];else if(t&&t[0].id===e)t=[t[0]];else return null;else{if(!t)return null;i=i.substr(1)}if(i==="")return[t[0]];if(i.charAt(0)==="/"){for(i=i.substr(1),r=t[0],u=i.split("/");u.length>0;){if(!r.hasOwnProperty(u[0]))return null;r=r[u[0]];t.push(r);u.shift()}return t}return null},l=function(n,t){var i,r,o=n.length-1,f,u,e=/^(\d+)/.exec(t);if(e){if(t=t.substr(e[0].length),f=parseInt(e[1],10),f<0||f>o)return;if(u=n[o-f],t==="#")return u.key}else u=n[0];if(r=u.object[u.key],t==="")return r;if(t.charAt(0)==="/"){for(t=t.substr(1),i=t.split("/");i.length>0;){if(i[0]=i[0].replace(/~1/g,"/").replace(/~0/g,"~"),!r.hasOwnProperty(i[0]))return;r=r[i[0]];i.shift()}return r}return},n=function(t,i,e,s){var c,v,g,rt,ft,w,d,b=!1,y={},a,k,ut,ht=i.length-1,h=i[ht],it,et=e.length-1,ot=e[et].object,st=e[et].key,p=ot[st],nt,tt;if(h.hasOwnProperty("$ref"))return i=u(t,i,h.$ref),i?n(t,i,e,s):{$ref:h.$ref};if(h.hasOwnProperty("type"))if(typeof h.type=="string"){if(s.useCoerce&&t.coerceType.hasOwnProperty(h.type)&&(p=ot[st]=t.coerceType[h.type](p)),!t.fieldType[h.type](p))return{type:h.type}}else{for(b=!0,c=0,v=h.type.length;c<v&&b;c++)t.fieldType[h.type[c]](p)&&(b=!1);if(b)return{type:h.type}}if(h.hasOwnProperty("allOf"))for(c=0,v=h.allOf.length;c<v;c++)if(a=n(t,i.concat(h.allOf[c]),e,s),a)return a;if(s.useCoerce||s.useDefault||s.removeAdditional){if(h.hasOwnProperty("oneOf")){for(tt=Infinity,c=0,v=h.oneOf.length,g=0;c<v;c++)if(it=r(e),a=n(t,i.concat(h.oneOf[c]),it,s),a)nt=a.schema?Object.keys(a.schema).length:1,nt<tt&&(tt=nt,y=a);else if(g=g+1,g>1)break;else f(it,e);if(g>1)return{oneOf:!0};if(g<1)return y;y={}}if(h.hasOwnProperty("anyOf")){for(y=null,tt=Infinity,c=0,v=h.anyOf.length;c<v;c++)if(it=r(e),a=n(t,i.concat(h.anyOf[c]),it,s),a)nt=a.schema?Object.keys(a.schema).length:1,nt<tt&&(tt=nt,y=a);else{f(it,e);y=null;break}if(y)return y}if(h.hasOwnProperty("not")&&(it=r(e),a=n(t,i.concat(h.not),it,s),!a))return{not:!0}}else{if(h.hasOwnProperty("oneOf")){for(tt=Infinity,c=0,v=h.oneOf.length,g=0;c<v;c++)if(a=n(t,i.concat(h.oneOf[c]),e,s),a)nt=a.schema?Object.keys(a.schema).length:1,nt<tt&&(tt=nt,y=a);else if(g=g+1,g>1)break;if(g>1)return{oneOf:!0};if(g<1)return y;y={}}if(h.hasOwnProperty("anyOf")){for(y=null,tt=Infinity,c=0,v=h.anyOf.length;c<v;c++)if(a=n(t,i.concat(h.anyOf[c]),e,s),a)nt=a.schema?Object.keys(a.schema).length:1,nt<tt&&(tt=nt,y=a);else{y=null;break}if(y)return y}if(h.hasOwnProperty("not")&&(a=n(t,i.concat(h.not),e,s),!a))return{not:!0}}if(h.hasOwnProperty("dependencies"))for(w in h.dependencies)if(h.dependencies.hasOwnProperty(w)&&p.hasOwnProperty(w))if(Array.isArray(h.dependencies[w])){for(c=0,v=h.dependencies[w].length;c<v;c++)if(!p.hasOwnProperty(h.dependencies[w][c]))return{dependencies:!0}}else if(a=n(t,i.concat(h.dependencies[w]),e,s),a)return a;if(Array.isArray(p)){if(h.hasOwnProperty("items"))if(Array.isArray(h.items)){for(c=0,v=h.items.length;c<v;c++)a=n(t,i.concat(h.items[c]),e.concat({object:p,key:c}),s),a!==null&&(y[c]=a,b=!0);if(p.length>v&&h.hasOwnProperty("additionalItems"))if(typeof h.additionalItems=="boolean"){if(!h.additionalItems)return{additionalItems:!0}}else for(c=v,v=p.length;c<v;c++)a=n(t,i.concat(h.additionalItems),e.concat({object:p,key:c}),s),a!==null&&(y[c]=a,b=!0)}else for(c=0,v=p.length;c<v;c++)a=n(t,i.concat(h.items),e.concat({object:p,key:c}),s),a!==null&&(y[c]=a,b=!0);else if(h.hasOwnProperty("additionalItems")&&typeof h.additionalItems!="boolean")for(c=0,v=p.length;c<v;c++)a=n(t,i.concat(h.additionalItems),e.concat({object:p,key:c}),s),a!==null&&(y[c]=a,b=!0);if(b)return{schema:y}}else{k=[];y={};for(w in p)p.hasOwnProperty(w)&&k.push(w);if(s.checkRequired&&h.required)for(c=0,v=h.required.length;c<v;c++)p.hasOwnProperty(h.required[c])||(y[h.required[c]]={required:!0},b=!0);if(rt=h.hasOwnProperty("properties"),ft=h.hasOwnProperty("patternProperties"),rt||ft)for(c=k.length;c--;){if(ut=!1,rt&&h.properties.hasOwnProperty(k[c])&&(ut=!0,a=n(t,i.concat(h.properties[k[c]]),e.concat({object:p,key:k[c]}),s),a!==null&&(y[k[c]]=a,b=!0)),ft)for(w in h.patternProperties)h.patternProperties.hasOwnProperty(w)&&k[c].match(w)&&(ut=!0,a=n(t,i.concat(h.patternProperties[w]),e.concat({object:p,key:k[c]}),s),a!==null&&(y[k[c]]=a,b=!0));ut&&k.splice(c,1)}if(s.useDefault&&rt&&!b)for(w in h.properties)h.properties.hasOwnProperty(w)&&!p.hasOwnProperty(w)&&h.properties[w].hasOwnProperty("default")&&(p[w]=h.properties[w]["default"]);if(s.removeAdditional&&rt&&h.additionalProperties!==!0&&typeof h.additionalProperties!="object")for(c=0,v=k.length;c<v;c++)delete p[k[c]];else if(h.hasOwnProperty("additionalProperties"))if(typeof h.additionalProperties=="boolean"){if(!h.additionalProperties)for(c=0,v=k.length;c<v;c++)y[k[c]]={additional:!0},b=!0}else for(c=0,v=k.length;c<v;c++)a=n(t,i.concat(h.additionalProperties),e.concat({object:p,key:k[c]}),s),a!==null&&(y[k[c]]=a,b=!0);if(b)return{schema:y}}for(d in h)h.hasOwnProperty(d)&&!o.hasOwnProperty(d)&&(d==="format"?t.fieldFormat.hasOwnProperty(h[d])&&!t.fieldFormat[h[d]](p,h,e,s)&&(y[d]=!0,b=!0):t.fieldValidate.hasOwnProperty(d)&&!t.fieldValidate[d](p,h[d].hasOwnProperty("$data")?l(e,h[d].$data):h[d],h,e,s)&&(y[d]=!0,b=!0));return b?y:null},a={useDefault:!1,useCoerce:!1,checkRequired:!0,removeAdditional:!1};i.prototype={validate:function(t,i,r){var o=[t],f=null,s=[{object:{__root__:i},key:"__root__"}],e;if(typeof t=="string"&&(o=u(this,null,t),!o))throw new Error("jjv: could not find schema '"+t+"'.");if(r)for(e in this.defaultOptions)this.defaultOptions.hasOwnProperty(e)&&!r.hasOwnProperty(e)&&(r[e]=this.defaultOptions[e]);else r=this.defaultOptions;return f=n(this,o,s,r),f?{validation:f.hasOwnProperty("schema")?f.schema:f}:null},resolveRef:function(n,t){return u(this,n,t)},addType:function(n,t){this.fieldType[n]=t},addTypeCoercion:function(n,t){this.coerceType[n]=t},addCheck:function(n,t){this.fieldValidate[n]=t},addFormat:function(n,t){this.fieldFormat[n]=t},addSchema:function(n,t){if(!t&&n&&(t=n,n=undefined),t.hasOwnProperty("id")&&typeof t.id=="string"&&t.id!==n){if(t.id.charAt(0)==="/")throw new Error("jjv: schema id's starting with / are invalid.");this.schema[e(t.id)]=t}else if(!n)throw new Error("jjv: schema needs either a name or id attribute.");n&&(this.schema[e(n)]=t)}};typeof module!="undefined"&&typeof module.exports!="undefined"?module.exports=i:typeof define=="function"&&define.amd?define(function(){return i}):this.jjv=i}).call(this);
//# sourceMappingURL=jjv.min.js.map
